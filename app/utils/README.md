# üõ† –£—Ç–∏–ª–∏—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (app/utils/)

–ü–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.    
–ü–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—É –¥—É–±–ª–∏—Ä—É–µ—Ç `src/utils/`, –Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω –¥–ª—è –∏–Ω—Ñ–µ—Ä–µ–Ω—Å–∞ –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –≥–æ—Ç–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π.  

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞
```
utils/
‚îú‚îÄ‚îÄ credit_preprocessor.py # –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (–∫–æ–ø–∏—è –∏–∑ src/utils/)
‚îî‚îÄ‚îÄ data_loader.py # –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –∏ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤
```


## üìÑ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### `credit_preprocessor.py`

–ö–æ–ø–∏—è `src/utils/credit_preprocessor.py` —Å —Ç–µ–º–∏ –∂–µ –∫–ª–∞—Å—Å–∞–º–∏:   
- `CreditDataPreprocessor` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏—á, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤, –≤—ã–±—Ä–æ—Å–æ–≤, –∫–æ–¥–æ–≤ 96/98  
- `CreditScaler` - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤  
- `check_business_rules` - **–∑–∞–ø–∞—Å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è** –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –±–∏–∑–Ω–µ—Å-–ø—Ä–∞–≤–∏–ª –Ω–∞ –æ–¥–Ω–æ–π –∞–Ω–∫–µ—Ç–µ   
  (–≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –±–∞—Ç—á–µ–≤–∞—è –≤–µ—Ä—Å–∏—è –∏–∑ `app/models/escalation.py`)  

**–ó–∞—á–µ–º –∫–æ–ø–∏—è?**  
–ß—Ç–æ–±—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—ã–ª–æ —Å–∞–º–æ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–º –∏ –Ω–µ –∑–∞–≤–∏—Å–µ–ª–æ –æ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—ã `src/` –ø—Ä–∏ –¥–µ–ø–ª–æ–µ.    
`src/utils` - –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –∏ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤  
`app/utils` - –¥–ª—è —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  

### `data_loader.py`

–§—É–Ω–∫—Ü–∏—è `load_artifacts(models_path, preprocessor_path)` —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º:

```python
@st.cache_resource
def load_artifacts(models_path, preprocessor_path):  
    """–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–≤ –∏ –º–æ–¥–µ–ª–µ–π —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º"""  
```
#### –ß—Ç–æ –∑–∞–≥—Ä—É–∂–∞–µ—Ç:
- –ü—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (preprocessor_150.pkl)   
- –°–∫–µ–π–ª–µ—Ä (scaler_150.pkl)   
- –°–ª–æ–≤–∞—Ä—å –º–æ–¥–µ–ª–µ–π:    
`Logistic Regression` - –º–æ–¥–µ–ª—å –ø–µ—Ä–≤–æ–≥–æ —É—Ä–æ–≤–Ω—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏  
`XGBoost` / `LightGBM` / `CatBoost` / `Random Forest` - –º–æ–¥–µ–ª–∏ –≤—Ç–æ—Ä–æ–≥–æ —É—Ä–æ–≤–Ω—è —ç—Å–∫–∞–ª–∞—Ü–∏–∏  

**–ü–æ—á–µ–º—É `@st.cache_resource`:**  
- –ú–æ–¥–µ–ª–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑** –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è  
- –ù–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  
- –≠–∫–æ–Ω–æ–º–∏—è –ø–∞–º—è—Ç–∏ –∏ –≤—Ä–µ–º–µ–Ω–∏  

### üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏
```
python
from app.utils.data_loader import load_artifacts

# –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤
preprocessor, scaler, models = load_artifacts(
    models_path='models/best/train_150/',
    preprocessor_path='preprocessors/'
)
# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —ç—Å–∫–∞–ª–∞—Ü–∏–∏
from app.models.escalation import escalation_decision

decision, manual_mask, stats = escalation_decision(
    input_data,
    models['Logistic Regression'],
    models['XGBoost'],
    'XGBoost',
    threshold=0.5,
    lr_margins=[0.35],
    second_margins=[0.4],
    preprocessor=preprocessor,
    scaler=scaler
)
```

üìö –ü–æ–¥—Ä–æ–±–Ω–µ–µ

[–£—Ç–∏–ª–∏—Ç—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è](../../src/utils/README.md)  
[–õ–æ–≥–∏–∫–∞ —ç—Å–∫–∞–ª–∞—Ü–∏–∏](../models/README.md)  
[–û–±—É—á–µ–Ω–Ω—ã–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã](../../preprocessors/README.md)  
