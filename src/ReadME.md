# üß† –û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π (src/)

–ü–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç —Å–∫—Ä–∏–ø—Ç—ã –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º **Hydra** –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥–∞–º–∏ –∏ **ClearML** –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞
src/
‚îú‚îÄ‚îÄ train_lgbm.py # –û–±—É—á–µ–Ω–∏–µ LightGBM
‚îú‚îÄ‚îÄ train_logreg.py # –û–±—É—á–µ–Ω–∏–µ Logistic Regression
‚îú‚îÄ‚îÄ train_xgb.py # –û–±—É—á–µ–Ω–∏–µ XGBoost
‚îú‚îÄ‚îÄ train_rfc.py # –û–±—É—á–µ–Ω–∏–µ Random Forest
‚îú‚îÄ‚îÄ train_catboost.py # –û–±—É—á–µ–Ω–∏–µ CatBoost
‚îú‚îÄ‚îÄ train_dtc.py # –û–±—É—á–µ–Ω–∏–µ Decision Tree
‚îú‚îÄ‚îÄ train_full_dataset.py # –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ utils/
‚îú‚îÄ‚îÄ credit_preprocessor.py # –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (sklearn API)
‚îú‚îÄ‚îÄ data_loader.py # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
‚îî‚îÄ‚îÄ metrics.py # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è ClearML

text

## üöÄ –ó–∞–ø—É—Å–∫ –æ–±—É—á–µ–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
```bash
# –ò–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞
python src/train_lgbm.py
–° –∫—Ä–æ—Å—Å-–≤–∞–ª–∏–¥–∞—Ü–∏–µ–π

bash
python src/train_lgbm.py experiment.model.use_cv=true
–° –¥—Ä—É–≥–∏–º –∫–æ–Ω—Ñ–∏–≥–æ–º

bash
python src/train_lgbm.py --config-name –¥—Ä—É–≥–æ–π_–∫–æ–Ω—Ñ–∏–≥.yaml
–ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤

bash
python src/train_lgbm.py model.params.learning_rate=0.1
‚öôÔ∏è –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç

1. Hydra –∫–æ–Ω—Ñ–∏–≥–∏

–ö–∞–∂–¥—ã–π —Å–∫—Ä–∏–ø—Ç –±–µ—Ä–µ—Ç –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏–∑ configs/experiment/:

lgbm_experiment.yaml
logreg_experiment.yaml
–∏ —Ç.–¥.
–ö–æ–Ω—Ñ–∏–≥–∏ –Ω–∞—Å–ª–µ–¥—É—é—Ç—Å—è —á–µ—Ä–µ–∑ defaults:

yaml
defaults:
  - /preprocessor: default
  - /model: lgbm
  - _self_
2. –ü–∞–π–ø–ª–∞–π–Ω –æ–±—É—á–µ–Ω–∏—è (data_loader.py)

–ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö (cs-train.csv, cs-test.csv)
–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test (—Å —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π)
–û—á–∏—Å—Ç–∫–∞ –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ CreditDataPreprocessor
–ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CreditScaler
3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ ClearML (metrics.py)

–ö–∞–∂–¥—ã–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç:

–ú–µ—Ç—Ä–∏–∫–∏: AUC, AP, Precision, Recall, F1
–ì—Ä–∞—Ñ–∏–∫–∏: ROC-–∫—Ä–∏–≤–∞—è, PR-–∫—Ä–∏–≤–∞—è, confusion matrix
Feature importance (–¥–ª—è tree-based)
–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–¥–ª—è –ª–∏–Ω–µ–π–Ω—ã—Ö –º–æ–¥–µ–ª–µ–π)
–†–µ–∑—É–ª—å—Ç–∞—Ç—ã GridSearchCV
üß™ –≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã

–í—Å–µ–≥–æ –ø—Ä–æ–≤–µ–¥–µ–Ω–æ 29 —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤:

–ü–æ 2-6 —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ –Ω–∞ –∫–∞–∂–¥—É—é –º–æ–¥–µ–ª—å
GridSearchCV/RandomizedSearchCV –¥–ª—è –ø–æ–¥–±–æ—Ä–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
–§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ –Ω–∞ –ø–æ–ª–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (150k —Å—Ç—Ä–æ–∫)
–ü–æ–¥—Ä–æ–±–Ω–µ–µ: EXPERIMENTS.md

üìä –§–∏–Ω–∞–ª—å–Ω–æ–µ –æ–±—É—á–µ–Ω–∏–µ (train_full_dataset.py)

–°–∫—Ä–∏–ø—Ç –¥–ª—è –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è –ª—É—á—à–∏—Ö –º–æ–¥–µ–ª–µ–π –Ω–∞ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö:

–ó–∞–≥—Ä—É–∂–∞–µ—Ç –ª—É—á—à–∏–µ –º–æ–¥–µ–ª–∏ –∏–∑ models/best/train_120/
–ò–∑–≤–ª–µ–∫–∞–µ—Ç —Ç–æ–ª—å–∫–æ –≥–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä—ã (–±–µ–∑ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤ fit)
–û–±—É—á–∞–µ—Ç –Ω–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ –Ω–∞ –ø–æ–ª–Ω–æ–º –¥–∞—Ç–∞—Å–µ—Ç–µ (150k —Å—Ç—Ä–æ–∫)
–°–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ models/best/train_150/
bash
python src/train_full_dataset.py
üîß –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –º–æ–¥–µ–ª–∏

–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ –≤ configs/model/ (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å lgbm.yaml)
–°–æ–∑–¥–∞—Ç—å –∫–æ–Ω—Ñ–∏–≥ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –≤ configs/experiment/
–°–æ–∑–¥–∞—Ç—å —Å–∫—Ä–∏–ø—Ç –æ–±—É—á–µ–Ω–∏—è (–ø–æ –∞–Ω–∞–ª–æ–≥–∏–∏ —Å train_lgbm.py)
–î–æ–±–∞–≤–∏—Ç—å –º–æ–¥–µ–ª—å –≤ app/utils/data_loader.py –¥–ª—è Streamlit
üìà –ú–µ—Ç—Ä–∏–∫–∏ –ª—É—á—à–∏—Ö –º–æ–¥–µ–ª–µ–π

–ú–æ–¥–µ–ª—å	AUC	–§–∞–π–ª
XGBoost	0.8681	models/best/train_150/xgb_150_model.pkl
LightGBM	0.8672	models/best/train_150/lgbm_150_model.pkl
CatBoost	0.8675	models/best/train_150/catboost_150_model.pkl
Logistic Regression	0.8578	models/best/train_150/logreg_150_model.pkl
üìö –ü–æ–¥—Ä–æ–±–Ω–µ–µ

–ö–æ–Ω—Ñ–∏–≥–∏ Hydra
–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã ClearML
Streamlit –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
