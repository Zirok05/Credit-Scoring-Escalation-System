# üõ† –£—Ç–∏–ª–∏—Ç—ã (src/utils/)

–ü–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏ –¥–ª—è –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–∏–Ω–≥–∞, –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –º–µ—Ç—Ä–∏–∫.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞
```
utils/
‚îú‚îÄ‚îÄ credit_preprocessor.py # –ö–∞—Å—Ç–æ–º–Ω—ã–π –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä (sklearn API)
‚îú‚îÄ‚îÄ data_loader.py # –ó–∞–≥—Ä—É–∑–∫–∞ –∏ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–∫—Ä–∏–ø—Ç–æ–≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤ ../src/train_'model_name'.py
‚îî‚îÄ‚îÄ metrics.py # –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–ª—è ClearML
```

## üìÑ –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤

### `credit_preprocessor.py`

–ö–∞—Å—Ç–æ–º–Ω—ã–π —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–µ—Ä, –Ω–∞—Å–ª–µ–¥—É—é—â–∏–π `BaseEstimator`, `TransformerMixin` –∏–∑ sklearn.  
–°–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –∏–∑ [EDA](..//../notebooks/EDA.ipynb)

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–ª–∞—Å—Å—ã:**
- `CreditDataPreprocessor` - —Å–æ–∑–¥–∞–Ω–∏–µ —Ñ–∏—á, –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–æ–ø—É—Å–∫–æ–≤, –≤—ã–±—Ä–æ—Å–æ–≤, –∫–æ–¥–æ–≤ 96/98
- `CreditScaler` - –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–æ–≤—ã—Ö –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (–±—É–ª–µ–≤—ã –Ω–µ —Ç—Ä–æ–≥–∞–µ—Ç)
- `check_business_rules` - —Ñ—É–Ω–∫—Ü–∏—è —Å –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–æ–π (–≤–æ–∑—Ä–∞—Å—Ç, –∫–æ–¥—ã, —ç–∫—Å—Ç—Ä–µ–º–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è)

### `data_loader.py`

–§—É–Ω–∫—Ü–∏—è `load_and_preprocess(cfg)`:
1. –ó–∞–≥—Ä—É–∑–∫–∞ `cs-train.csv` –∏ `cs-test.csv`
2. –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/test —Å–æ —Å—Ç—Ä–∞—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π
3. –û—á–∏—Å—Ç–∫–∞ –æ—Ç –≤—ã–±—Ä–æ—Å–æ–≤ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
4. –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `CreditDataPreprocessor`
5. –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ `CreditScaler`
6. –í–æ–∑–≤—Ä–∞—Ç —Å–ª–æ–≤–∞—Ä—è —Å `X_train`, `X_test`, `X_predict`, `y_train`, `y_test`, –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä–æ–º –∏ —Å–∫–µ–π–ª–µ—Ä–æ–º

### `metrics.py`

–ù–∞–±–æ—Ä —Ñ—É–Ω–∫—Ü–∏–π –¥–ª—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ –∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –≤ ClearML:

**–ì—Ä–∞—Ñ–∏–∫–∏:**
- `plot_roc_curve` - ROC-–∫—Ä–∏–≤–∞—è —Å AUC  
- `plot_pr_curve` - Precision-Recall –∫—Ä–∏–≤–∞—è —Å AP  
- `plot_confusion_matrix` - –º–∞—Ç—Ä–∏—Ü–∞ –æ—à–∏–±–æ–∫  
- `plot_distribution` - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –ø–æ –∏—Å—Ç–∏–Ω–Ω—ã–º –∫–ª–∞—Å—Å–∞–º  
- `plot_feature_importance` - –≤–∞–∂–Ω–æ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ (tree-based)  
- `plot_coefficients` - –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã (–ª–∏–Ω–µ–π–Ω—ã–µ –º–æ–¥–µ–ª–∏)  
- `plot_LogisticRegressionCV` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã CV –¥–ª—è –ª–æ–≥–∏—Å—Ç–∏—á–µ—Å–∫–æ–π —Ä–µ–≥—Ä–µ—Å—Å–∏–∏  
- `plot_GridSearchCV` - —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã GridSearchCV  
- `plot_log_metrics` - –≤—Å–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ (AUC, AP, Precision, Recall, F1, MCC)  

## üîß –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

–≠—Ç–∏ –º–æ–¥—É–ª–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö –æ–±—É—á–µ–Ω–∏—è (`train_'model_name'.py`) –∏ –Ω–µ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –ø—Ä—è–º–æ–≥–æ –∑–∞–ø—É—Å–∫–∞.  

```python
# –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ —Å–∫—Ä–∏–ø—Ç–µ –æ–±—É—á–µ–Ω–∏—è
from utils.data_loader import load_and_preprocess
from utils.metrics import plot_roc_curve  

data = load_and_preprocess(cfg)  
plot_roc_curve(data['y_test'], test_pred, test_auc, task)  
```
üìö –ü–æ–¥—Ä–æ–±–Ω–µ–µ  
[–û–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π](../README.md)  
[–ö–æ–Ω—Ñ–∏–≥–∏](../../configs/README.md)  
[–û–±—É—á–µ–Ω–Ω—ã–µ –ø—Ä–µ–ø—Ä–æ—Ü–µ—Å—Å–æ—Ä—ã](../../preprocessors/README.md)  
